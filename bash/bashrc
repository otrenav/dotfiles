#!/usr/bin/env bash

#
# Aliases
#
alias grep='grep --color=auto'
alias gg='grep --color=auto -rnwi . -e'
alias p='cd ~/Projects; ls;'
alias d='cd ~/Downloads; ls;'
alias file_count='find . -type -f | wc -l'
unamestr=`uname`
if [[ "$unamestr" == 'Linux' ]]; then
    double_click='xdg-open'
    alias lsall='ls -flaF --color=auto'
    alias ls='ls -lGF --color=auto'
    # TODO: Check this is updated
    export PATH="/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/usr/texbin:/bin:/sbin:${PATH}"
elif [[ "$unamestr" == 'Darwin' ]]; then
    alias lsall='ls -flaF'
    alias ls='ls -lGF'
    alias julia='/Applications/Julia-0.4.0.app/Contents/Resources/julia/bin/julia'
    alias start_mysql='launchctl load ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist'
    alias stop_mysql='launchctl unload ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist'
    # TODO: Check this is updated
    export PATH="/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/usr/texbin:/bin:/sbin:${PATH}"
fi
export PATH

#
# R
#
alias R='R --no-save'
alias r='R --no-save'
export R_PROFILE_USER='~/.Rprofile'

#
# Bash-It
#
export BASH_IT=$HOME/.bash_it
export BASH_IT_THEME='otrenav'
if [ -e $BASH_IT/bash_it.sh ]; then
    source $BASH_IT/bash_it.sh
fi
HISTCONTROL=ignoredups:ignorespace

#
# Git
#
source ~/Projects/system/dotfiles/git/git-completion.bash

#
# Google Cloud
#
if [ -e ~/Projects/system/google-cloud/completion.bash.inc ]; then
    source ~/Projects/system/google-cloud/path.bash.inc
    source ~/Projects/system/google-cloud/completion.bash.inc
fi

#
# Emacs
#
if [[ "$unamestr" == 'Linux' ]]; then
    export kill_emacs="emacsclient -e '(save-buffers-kill-emacs)'"
    export EDITOR="emacsclient -t"
    export VISUAL="emacsclient -c -a emacs"
    export ALTERNATE_EDITOR=""
    function emax() {
        emacsclient -c -a "emacs" "$@" &
    }
elif [[ "$unamestr" == 'Darwin' ]]; then
    alias emacs='/Applications/Emacs.app/Contents/MacOS/Emacs'
    export EDITOR="/Applications/Emacs.app/Contents/MacOS/Emacs"
fi

#
# Score Data
#
alias s='cd ~/Projects/datata/score-data/project/; ls;'
function switch_database() {
    echo "[+] Switching database (development) for Score Data..."
    mysql -u root < ~/Projects/system/dotfiles/sql/switch_database.sql
    mysql -u root development < $1
    echo "[+] Done."
}

#
# Python
#
alias kp='killall python'
alias rm_pyc='find . -name "*.pyc" -exec rm {} \;'
export WORKON_HOME=~/Projects/system/python/envs
source `which virtualenvwrapper.sh`

#
# Django
#
alias m='./manage.py'
alias dj='./manage.py runserver'
alias ds='./manage.py shell_plus'
alias rm_migrations='find . -name "000*.py*" -exec rm {} \;'
source ~/Projects/system/dotfiles/bash/scripts/django_bash_completion.bash

#
# Functions
#
function file_directory_size() {
    if du -b /dev/null > /dev/null 2>&1; then
        local arg=-sbh
    else
        local arg=-sh
    fi
    if [[ -n "$@" ]]; then
        du $arg -- "$@"
    else
        du $arg .[^.]* *
    fi
}

function sk() {
    gpg $1
    f=$(echo $1 | sed 's/\.[^.]*$//')
    more "${f}"
    rm "${f}"
}
